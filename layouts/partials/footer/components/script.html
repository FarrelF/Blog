{{- partial "helper/external" (dict "Context" . "Namespace" "Vibrant") -}}

{{- $Permalink := "" -}}
{{- $script := "" -}}
{{- if ne hugo.IsProduction false -}}
    {{- $script = resources.Get "ts/main.ts" | js.Build | minify | fingerprint "sha384" -}}
    {{- $Permalink = $script.RelPermalink -}}
    {{- if .Site.Params.CDN.JS.URL -}}
        {{- $Permalink = printf "%s%s" $.Site.Params.CDN.JS.URL $script.RelPermalink -}}
    {{- end -}}
{{- else -}}
    {{- $script = resources.Get "ts/main.ts" | js.Build | minify | fingerprint "sha384" -}}
    {{- $Permalink = $script.RelPermalink -}}
{{- end -}}

<script type="text/javascript" src="{{ $Permalink }}" integrity="{{ $script.Data.Integrity }}" {{ if and (.Site.Params.CDN.JS.URL) (eq hugo.IsProduction true) }}crossorigin="anonymous"{{ end }} defer></script>
